<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Pipeviz</title>
        <link rel="icon" href="https://raw.githubusercontent.com/mattlianje/d4/master/pix/pipeviz.png" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
        <script src="https://d3js.org/d3.v7.min.js"></script>
        <script src="https://unpkg.com/@hpcc-js/wasm@2.13.0/dist/graphviz.umd.js"></script>
        <script src="https://unpkg.com/d3-graphviz@5.0.2/build/d3-graphviz.min.js"></script>
        <style>
            :root {
                --bg-primary: #fff;
                --bg-secondary: #f5f5f5;
                --bg-code: #f5f5f5;
                --text-primary: #000;
                --text-secondary: #666;
                --text-muted: #828282;
                --border-color: #ccc;
                --border-light: #eee;
            }
            [data-theme='dark'] {
                --bg-primary: #1a1a1a;
                --bg-secondary: #252525;
                --bg-code: #2d2d2d;
                --text-primary: #e0e0e0;
                --text-secondary: #aaa;
                --text-muted: #888;
                --border-color: #444;
                --border-light: #333;
            }
            html {
                overflow-y: scroll;
            }
            /* Prevent modal from causing body padding jitter */
            body.modal-open {
                padding-right: 0 !important;
            }
            .modal-backdrop {
                width: 100% !important;
            }
            body {
                background-color: var(--bg-primary);
                min-height: 100vh;
                font-family: Verdana, Geneva, sans-serif;
                font-size: 13px;
                color: var(--text-primary);
            }
            .hero-section {
                background: var(--bg-primary);
                margin: 1rem auto;
                padding: 1.5rem 4rem;
                max-width: 1600px;
            }
            @media (max-width: 768px) {
                .hero-section {
                    padding: 1.5rem 1.5rem;
                }
                .feature-grid {
                    grid-template-columns: 1fr !important;
                }
            }
            .nav-tabs {
                border-bottom: 1px solid var(--border-color);
                margin-bottom: 1.5rem;
            }
            .nav-tabs .nav-link {
                border: none;
                color: var(--text-muted);
                font-weight: 400;
                padding: 6px 12px;
                margin-right: 2px;
                background: transparent;
                border-radius: 0;
                font-size: 12px;
            }
            .nav-tabs .nav-link:hover {
                color: var(--text-primary);
                background-color: var(--bg-secondary);
            }
            .nav-tabs .nav-link.active {
                background-color: var(--bg-primary);
                color: var(--text-primary);
                border-bottom: 2px solid var(--text-primary);
            }
            .nav-tabs.hidden-on-home {
                display: none;
            }
            .nav-separator {
                width: 1px;
                background: var(--border-color);
                margin: 8px 6px;
                opacity: 0.5;
            }
            @media (max-width: 768px) {
                .nav-separator {
                    display: none;
                }
            }
            .card {
                border: none;
                border-radius: 0;
                box-shadow: none;
                background: transparent;
            }
            .card-body {
                padding: 0;
            }
            .table-container {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            .table {
                background: var(--bg-primary);
                font-size: 13px;
                border-collapse: collapse;
                table-layout: fixed;
                width: 100%;
                min-width: 900px;
            }
            .table th {
                background-color: var(--bg-secondary);
                border-bottom: 1px solid var(--border-color);
                font-weight: bold;
                color: var(--text-primary);
                white-space: nowrap;
                font-size: 11px;
            }
            .table td {
                border-bottom: 1px solid var(--border-light);
                vertical-align: top;
                color: var(--text-primary);
                overflow: hidden;
            }
            .table td > div {
                overflow-x: auto;
            }
            .table .col-sources > div,
            .table .col-tags > div {
                white-space: normal;
            }
            .table .col-sources .badge,
            .table .col-tags .badge {
                display: block;
                width: fit-content;
                margin-bottom: 2px;
            }
            .table tr:last-child td {
                border-bottom: none;
            }
            .table .col-name {
                width: 200px;
                font-size: 0.85em;
            }
            .table .col-desc {
                width: 250px;
                font-size: 0.8em;
            }
            .table .col-schedule {
                width: 100px;
            }
            .table .col-sources {
                width: 340px;
            }
            .table .col-cluster {
                width: 120px;
            }
            .table .col-tags {
                width: 160px;
            }
            .table .col-links {
                width: 140px;
            }
            .links-scroll {
                display: flex;
                flex-wrap: wrap;
                gap: 3px;
            }
            .links-scroll a {
                white-space: nowrap;
            }
            .table .col-owner {
                width: 180px;
            }
            .table .col-metadata {
                width: 200px;
            }
            .badge {
                font-weight: normal;
                font-size: 11px;
                padding: 2px 5px;
                border-radius: 2px;
                display: inline-block;
                margin-bottom: 2px;
            }
            .badge-snowflake {
                background-color: #e8f4fd;
                color: #0366d6;
                border: 1px solid #0366d6;
            }
            .badge-delta {
                background-color: #fff3e0;
                color: #e65100;
                border: 1px solid #e65100;
            }
            .badge-s3 {
                background-color: #fff8e1;
                color: #f57c00;
                border: 1px solid #f57c00;
            }
            .badge-api {
                background-color: #e8f5e9;
                color: #2e7d32;
                border: 1px solid #2e7d32;
            }
            .badge-database {
                background-color: #f3e5f5;
                color: #7b1fa2;
                border: 1px solid #7b1fa2;
            }
            .badge-tag {
                background-color: #fff3e0;
                color: #e65100;
                border: 1px solid #e65100;
            }
            .badge-cluster {
                background-color: #e3f2fd;
                color: #1565c0;
                border: 1px solid #1565c0;
            }
            .graph-container {
                background: var(--bg-primary);
                min-height: 500px;
                position: relative;
                border: 1px solid var(--border-color);
                overflow: hidden;
            }
            .graph-container svg {
                max-width: 100%;
            }
            .graph-controls {
                position: absolute;
                top: 10px;
                left: 10px;
                right: 10px;
                z-index: 10;
                display: flex;
                flex-wrap: wrap;
                gap: 4px;
                align-items: center;
            }
            .analysis-toggle {
                display: flex;
                align-items: center;
                gap: 6px;
            }
            .analysis-toggle input {
                display: none;
            }
            .graph-ctrl-btn {
                padding: 4px 10px;
                font-size: 11px;
                border: 1px solid var(--border-color);
                border-radius: 3px;
                cursor: pointer;
                background: var(--bg-primary);
                color: var(--text-secondary);
                transition: all 0.15s;
                font-family: inherit;
            }
            .graph-ctrl-btn:hover {
                border-color: var(--text-muted);
                color: var(--text-primary);
            }
            .graph-ctrl-btn:active {
                background: var(--bg-secondary);
            }
            .graph-ctrl-btn.danger {
                border-color: #c98b8b;
                color: #c98b8b;
            }
            .graph-ctrl-btn.danger:hover {
                background: #fbe9e7;
                border-color: #c98b8b;
                color: #8b5a5a;
            }
            [data-theme='dark'] .graph-ctrl-btn.danger:hover {
                background: rgba(201, 139, 139, 0.15);
                color: #e0a0a0;
            }
            .node-actions {
                display: flex;
                flex-wrap: wrap;
                gap: 6px;
                margin: 10px 0;
            }
            .format-toggle {
                display: flex;
                gap: 4px;
            }
            .export-format-btn.active,
            .backfill-view-btn.active {
                background: #e3f2fd;
                border-color: #2196f3;
                color: #1565c0;
            }
            [data-theme='dark'] .export-format-btn.active,
            [data-theme='dark'] .backfill-view-btn.active {
                background: rgba(33, 150, 243, 0.2);
                color: #90caf9;
            }
            .backfill-view-btn.danger.active {
                background: #fbe9e7;
                border-color: #c98b8b;
                color: #8b5a5a;
            }
            [data-theme='dark'] .backfill-view-btn.danger.active {
                background: rgba(201, 139, 139, 0.15);
                color: #e0a0a0;
            }
            #pipelines-only-btn.active,
            #collapse-all-btn.active {
                background: #e3f2fd;
                border-color: #2196f3;
                color: #1565c0;
            }
            [data-theme='dark'] #pipelines-only-btn.active,
            [data-theme='dark'] #collapse-all-btn.active {
                background: rgba(33, 150, 243, 0.2);
                color: #90caf9;
            }
            .analysis-toggle label {
                display: flex;
                align-items: center;
                gap: 4px;
                padding: 4px 10px;
                font-size: 11px;
                border: 1px solid var(--border-color);
                border-radius: 3px;
                cursor: pointer;
                background: var(--bg-primary);
                color: var(--text-secondary);
                transition: all 0.15s;
            }
            .analysis-toggle label:hover {
                border-color: var(--text-muted);
            }
            #cp-toggle:checked + label {
                background: #fce4ec;
                border-color: #d63384;
                color: #ad1457;
            }
            [data-theme='dark'] #cp-toggle:checked + label {
                background: rgba(214, 51, 132, 0.2);
                color: #f48fb1;
            }
            #cost-toggle:checked + label {
                background: #e8f5e9;
                border-color: #66bb6a;
                color: #2e7d32;
            }
            [data-theme='dark'] #cost-toggle:checked + label {
                background: rgba(102, 187, 106, 0.2);
                color: #a5d6a7;
            }
            .cp-indicator,
            .cost-indicator {
                width: 8px;
                height: 8px;
                border-radius: 50%;
                background: #ccc;
            }
            #cp-toggle:checked + label .cp-indicator {
                background: #d63384;
                box-shadow: 0 0 6px #d63384;
            }
            #cost-toggle:checked + label .cost-indicator {
                background: #66bb6a;
                box-shadow: 0 0 6px #66bb6a;
            }
            .overflow-menu-container {
                position: relative;
            }
            .overflow-menu-btn {
                padding: 4px 8px;
                font-size: 11px;
                border: 1px solid var(--border-color);
                border-radius: 3px;
                cursor: pointer;
                background: var(--bg-primary);
                color: var(--text-secondary);
                transition: all 0.15s;
                font-family: inherit;
                line-height: 1;
            }
            .overflow-menu-btn:hover {
                border-color: var(--text-muted);
                color: var(--text-primary);
            }
            .overflow-menu {
                display: none;
                position: absolute;
                top: 100%;
                right: 0;
                margin-top: 4px;
                background: var(--bg-primary);
                border: 1px solid var(--border-color);
                border-radius: 3px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
                z-index: 100;
                min-width: 160px;
            }
            .overflow-menu.show {
                display: block;
            }
            .overflow-menu-item {
                display: block;
                padding: 8px 12px;
                font-size: 11px;
                color: var(--text-primary);
                cursor: pointer;
                border: none;
                background: none;
                width: 100%;
                text-align: left;
            }
            .overflow-menu-item:hover {
                background: var(--bg-secondary);
            }
            .overflow-menu-item.active {
                background: #e3f2fd;
                color: #1565c0;
            }
            [data-theme='dark'] .overflow-menu-item.active {
                background: rgba(33, 150, 243, 0.2);
                color: #90caf9;
            }
            .overflow-menu-divider {
                height: 1px;
                background: var(--border-color);
                margin: 4px 0;
            }
            #graph svg {
                width: 100%;
                height: 500px;
            }
            .legend {
                position: absolute;
                bottom: 10px;
                left: 10px;
                background: var(--bg-primary);
                padding: 8px 12px;
                font-size: 11px;
                max-width: 160px;
                opacity: 0.9;
                color: var(--text-primary);
            }
            .json-editor {
                font-family: monospace;
                font-size: 12px;
                border: 1px solid var(--border-color);
                border-radius: 2px;
                background: var(--bg-primary);
                color: var(--text-primary);
            }
            .json-editor:focus {
                border-color: var(--text-muted);
                box-shadow: none;
                outline: none;
            }
            .node-highlighted {
                stroke: #e65100 !important;
                stroke-width: 3px !important;
                filter: drop-shadow(0 0 4px rgba(230, 81, 0, 0.4));
            }
            .node-highlighted polygon,
            .node-highlighted ellipse,
            .node-highlighted path {
                fill: #fff3e0 !important;
            }
            .node-highlighted text {
                font-weight: normal !important;
                fill: #000;
                stroke: none !important;
                stroke-width: 0 !important;
            }
            .node-highlighted text[fill='#d63384'] {
                fill: #d63384 !important;
            }
            .node-connected {
                stroke: #7b1fa2 !important;
                stroke-width: 1.5px !important;
            }
            .node-connected text {
                font-weight: normal !important;
                fill: #000;
                stroke: none !important;
                stroke-width: 0 !important;
            }
            .node-connected text[fill='#d63384'] {
                fill: #d63384 !important;
            }
            .node-dimmed {
                opacity: 0.35 !important;
                transition: opacity 0.2s ease;
            }
            .node-critical-path {
                filter: drop-shadow(0 0 8px rgba(214, 51, 132, 0.6)) drop-shadow(0 0 3px rgba(214, 51, 132, 0.8));
            }
            .node-critical-path polygon,
            .node-critical-path ellipse,
            .node-critical-path path {
                stroke: #d63384 !important;
                stroke-width: 2px !important;
            }
            .edge-critical-path path {
                stroke: #d63384 !important;
                stroke-width: 2.5px !important;
            }
            .edge-critical-path polygon {
                stroke: #d63384 !important;
                fill: #d63384 !important;
            }
            .node-costliest-path {
                filter: drop-shadow(0 0 8px rgba(102, 187, 106, 0.6)) drop-shadow(0 0 3px rgba(102, 187, 106, 0.8));
            }
            .node-costliest-path polygon,
            .node-costliest-path ellipse,
            .node-costliest-path path {
                stroke: #66bb6a !important;
                stroke-width: 2px !important;
            }
            .edge-costliest-path path {
                stroke: #66bb6a !important;
                stroke-width: 2.5px !important;
            }
            .edge-costliest-path polygon {
                stroke: #66bb6a !important;
                fill: #66bb6a !important;
            }
            .edge-highlighted {
                stroke: #7b1fa2 !important;
                stroke-width: 1.5px !important;
            }
            .edge-dimmed {
                opacity: 0.18 !important;
                transition: opacity 0.2s ease;
            }
            .cluster-highlighted > polygon,
            .cluster-highlighted > path {
                stroke: #e65100 !important;
                stroke-width: 3px !important;
                filter: drop-shadow(0 0 4px rgba(230, 81, 0, 0.4));
                fill: #fff3e0 !important;
            }
            .cluster-connected > polygon,
            .cluster-connected > path {
                stroke: #7b1fa2 !important;
                stroke-width: 1.5px !important;
            }
            .cluster-dimmed {
                opacity: 0.35 !important;
                transition: opacity 0.2s ease;
            }
            .node-tooltip {
                position: absolute;
                background: #000;
                color: #fff;
                padding: 6px 8px;
                font-size: 11px;
                pointer-events: none;
                z-index: 1000;
                max-width: 280px;
                white-space: pre-line;
            }
            .node {
                cursor: pointer;
                transition: all 0.2s ease;
            }
            .node:hover {
                stroke-width: 2px !important;
                filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.3));
            }
            .node:hover text {
                font-weight: normal !important;
                fill: #000 !important;
                stroke: none !important;
                stroke-width: 0 !important;
            }
            .node-details-panel {
                background: var(--bg-primary);
                padding: 1rem;
                min-height: 500px;
                max-height: 500px;
                overflow-y: auto;
                overflow-x: auto;
            }
            .node-details-panel .detail-value,
            .node-details-panel .lineage-link {
                white-space: nowrap;
            }
            .node-details-panel h5 {
                color: var(--text-primary);
                margin-bottom: 1rem;
                padding-bottom: 0.5rem;
                border-bottom: 1px solid var(--border-color);
                font-weight: bold;
                font-size: 13px;
            }
            .node-details-panel .detail-label {
                font-size: 10px;
                color: var(--text-muted);
                font-weight: bold;
                margin-bottom: 0.25rem;
            }
            .node-details-panel .detail-value {
                margin-bottom: 1rem;
                font-size: 12px;
                color: var(--text-primary);
            }
            .group-toggle-section {
                margin: 1rem 0;
            }
            .group-membership {
                display: flex;
                align-items: center;
                gap: 8px;
                margin-bottom: 1rem;
            }
            .lineage-link {
                margin-bottom: 4px;
                cursor: pointer;
                color: #0366d6;
            }
            .lineage-link:hover {
                text-decoration: underline;
            }
            [data-theme='dark'] .lineage-link {
                color: #58a6ff;
            }
            .lineage-view-toggle {
                display: flex;
                align-items: center;
                gap: 8px;
                margin-bottom: 0.75rem;
                margin-top: 0.5rem;
                font-size: 10px;
                color: var(--text-muted);
            }
            .lineage-toggle-label {
                opacity: 0.6;
                transition: opacity 0.2s;
            }
            .lineage-toggle-label.active {
                opacity: 1;
                color: var(--text-primary);
            }
            .lineage-toggle-slider {
                position: relative;
                width: 32px;
                height: 16px;
                background: var(--border-color);
                border-radius: 8px;
                cursor: pointer;
                transition: background 0.2s;
            }
            .lineage-toggle-slider::after {
                content: '';
                position: absolute;
                top: 2px;
                left: 2px;
                width: 12px;
                height: 12px;
                background: var(--bg-primary);
                border-radius: 50%;
                transition: transform 0.2s;
                box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            }
            .lineage-toggle-slider.json-active {
                background: var(--text-muted);
            }
            .lineage-toggle-slider.json-active::after {
                transform: translateX(16px);
            }
            .lineage-json-pre {
                font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', monospace;
                font-size: 10px;
                line-height: 1.4;
                background: var(--bg-code);
                border: 1px solid var(--border-light);
                padding: 0.75rem;
                margin: 0;
                overflow-x: auto;
                white-space: pre;
                max-height: 400px;
                overflow-y: auto;
                color: var(--text-primary);
            }
            [data-theme='dark'] .lineage-json-pre {
                background: #1e1e1e;
                border-color: #333;
            }
            .export-format-btn.active {
                background: var(--text-primary) !important;
                color: var(--bg-primary) !important;
                border-color: var(--text-primary) !important;
            }
            .export-output-container {
                position: relative;
            }
            .export-output {
                font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', monospace;
                font-size: 11px;
                line-height: 1.5;
                background: var(--bg-code);
                border: 1px solid var(--border-color);
                padding: 2.5rem 1rem 1rem 1rem;
                margin: 0;
                height: 520px;
                overflow: auto;
                white-space: pre;
                color: var(--text-primary);
            }
            .export-copy-btn {
                position: absolute;
                top: 8px;
                right: 8px;
                background: var(--bg-secondary);
                border: 1px solid var(--border-color);
                border-radius: 4px;
                padding: 4px 8px;
                cursor: pointer;
                opacity: 0.6;
                transition:
                    opacity 0.15s,
                    background 0.15s;
                color: var(--text-secondary);
                display: flex;
                align-items: center;
                gap: 4px;
                font-size: 10px;
            }
            .export-copy-btn:hover {
                opacity: 1;
                background: var(--bg-primary);
            }
            .export-copy-btn.copied {
                opacity: 1;
                color: #2e7d32;
            }
            .backfill-graph-container {
                border: 1px solid var(--border-color);
                background: var(--bg-primary);
                min-height: 450px;
                overflow: hidden;
            }
            .backfill-graph {
                width: 100%;
                height: 450px;
                overflow: hidden;
            }
            .backfill-graph svg {
                width: 100%;
                height: 100%;
            }
            .backfill-view-btn.active {
                background: var(--text-primary) !important;
                color: var(--bg-primary) !important;
                border-color: var(--text-primary) !important;
            }
            .backfill-hint {
                font-size: 11px;
                color: var(--text-muted);
                margin-bottom: 0.75rem;
                font-style: italic;
            }
            .backfill-pipeline-picker {
                position: relative;
            }
            .backfill-view-btn + .backfill-view-btn {
                margin-left: 4px;
            }
            @media (max-width: 768px) {
                .backfill-view-btn {
                    font-size: 11px !important;
                    padding: 4px 8px !important;
                }
            }
            @media (max-width: 576px) {
                #backfill-pane .card-body > .d-flex.justify-content-between {
                    flex-direction: column;
                    align-items: flex-start !important;
                    gap: 0.75rem;
                }
                #backfill-pane .card-body > .d-flex.justify-content-between > .d-flex {
                    width: 100%;
                    flex-wrap: wrap;
                    gap: 0.5rem;
                }
                #backfill-pane .btn-group {
                    width: 100%;
                    display: flex;
                }
                #backfill-pane .btn-group .backfill-view-btn {
                    flex: 1;
                    font-size: 10px !important;
                    padding: 6px 4px !important;
                    white-space: nowrap;
                }
                .backfill-pipeline-picker {
                    flex: 1;
                    min-width: 0;
                }
                .backfill-picker-dropdown {
                    position: fixed !important;
                    top: auto !important;
                    bottom: 0 !important;
                    left: 0 !important;
                    right: 0 !important;
                    min-width: 100% !important;
                    max-height: 55vh !important;
                    border-radius: 12px 12px 0 0 !important;
                }
            }
            .backfill-picker-dropdown {
                display: none;
                position: absolute;
                top: 100%;
                right: 0;
                background: var(--bg-primary);
                border: 1px solid var(--border-color);
                border-radius: 4px;
                width: 280px;
                max-height: 380px;
                z-index: 1000;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            }
            .backfill-picker-dropdown.show {
                display: block;
            }
            .backfill-picker-search {
                padding: 8px;
                border-bottom: 1px solid var(--border-light);
            }
            .backfill-picker-search input {
                width: 100%;
                padding: 6px 10px;
                border: 1px solid var(--border-color);
                border-radius: 4px;
                font-size: 12px;
                background: var(--bg-secondary);
                color: var(--text-primary);
            }
            .backfill-picker-search input:focus {
                outline: none;
                border-color: var(--accent-color);
            }
            .backfill-picker-search input::placeholder {
                color: var(--text-muted);
            }
            .backfill-picker-list {
                max-height: 260px;
                overflow-y: auto;
                padding: 0.25rem 0;
            }
            .backfill-picker-item {
                display: flex;
                align-items: center;
                gap: 8px;
                padding: 6px 12px;
                cursor: pointer;
                font-size: 12px;
                color: var(--text-primary);
                transition: background 0.1s;
            }
            .backfill-picker-item:hover {
                background: var(--bg-secondary);
            }
            .backfill-picker-item.hidden {
                display: none;
            }
            .backfill-picker-item input {
                margin: 0;
                cursor: pointer;
            }
            .picker-ds-tag {
                margin-left: auto;
                font-size: 9px;
                color: var(--text-muted);
                background: var(--bg-secondary);
                padding: 1px 5px;
                border-radius: 3px;
                opacity: 0.7;
            }
            .backfill-picker-group {
                font-size: 10px;
                font-weight: bold;
                color: var(--text-muted);
                padding: 8px 12px 4px;
                text-transform: uppercase;
            }
            .backfill-picker-group.hidden {
                display: none;
            }
            .backfill-picker-footer {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 6px 12px;
                border-top: 1px solid var(--border-light);
                font-size: 11px;
                color: var(--text-muted);
            }
            .backfill-picker-clear {
                background: none;
                border: none;
                color: var(--text-muted);
                font-size: 11px;
                cursor: pointer;
                padding: 2px 6px;
                border-radius: 3px;
            }
            .backfill-picker-clear:hover {
                color: var(--text-primary);
                background: var(--bg-secondary);
            }
            .node-details-panel .detail-value:last-child {
                margin-bottom: 0;
            }
            .node-details-panel .links-section {
                margin-top: 1rem;
                padding-top: 1rem;
                border-top: 1px solid #eee;
            }
            .node-details-panel .link-btn {
                display: inline-block;
                margin-right: 0.5rem;
                margin-bottom: 0.5rem;
                border-color: var(--border-color);
                color: var(--text-secondary);
                background: var(--bg-secondary);
            }
            .node-details-panel .link-btn:hover {
                background-color: var(--text-secondary);
                border-color: var(--text-secondary);
                color: var(--bg-primary);
            }
            [data-theme='dark'] .node-details-panel .link-btn {
                border-color: #666;
                color: #ccc;
                background: #333;
            }
            [data-theme='dark'] .node-details-panel .link-btn:hover {
                background-color: #888;
                border-color: #888;
                color: #fff;
            }
            .search-results-dropdown {
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: var(--bg-primary);
                border: 1px solid var(--border-color);
                border-top: none;
                max-height: 300px;
                overflow-y: auto;
                z-index: 100;
                display: none;
            }
            .search-results-dropdown.show {
                display: block;
            }
            .search-result-item {
                padding: 6px 10px;
                cursor: pointer;
                border-bottom: 1px solid var(--border-light);
                display: flex;
                align-items: center;
                gap: 8px;
                font-size: 12px;
                color: var(--text-primary);
            }
            .search-result-item:last-child {
                border-bottom: none;
            }
            .search-result-item:hover,
            .search-result-item.selected {
                background-color: var(--bg-secondary);
            }
            .search-result-item .result-type {
                font-size: 9px;
                padding: 2px 4px;
                text-transform: uppercase;
                font-weight: 600;
                letter-spacing: 0.5px;
            }
            .search-result-item .result-type.pipeline {
                background-color: #e3f2fd;
                color: #1565c0;
                border: 1px solid #1565c0;
            }
            .search-result-item .result-type.datasource {
                background-color: #f3e5f5;
                color: #7b1fa2;
                border: 1px solid #7b1fa2;
            }
            .search-result-item .result-name {
                font-weight: 400;
            }
            .search-result-item .result-match {
                color: #d84315;
                font-weight: 600;
            }
            .btn {
                border-radius: 0;
                font-size: 12px;
                font-weight: 400;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            .btn-primary {
                background-color: #333;
                border-color: #333;
                color: #fff;
            }
            .btn-primary:hover {
                background-color: #000;
                border-color: #000;
                color: #fff;
            }
            .btn-outline-primary {
                color: #333;
                border-color: #333;
            }
            .btn-outline-primary:hover {
                background-color: #333;
                border-color: #333;
                color: #fff;
            }
            .btn-outline-secondary {
                color: #666;
                border-color: #999;
            }
            .btn-outline-secondary:hover {
                background-color: #666;
                border-color: #666;
                color: #fff;
            }
            .btn-outline-warning {
                color: #b45309;
                border-color: #b45309;
            }
            .btn-outline-warning:hover {
                background-color: #b45309;
                border-color: #b45309;
                color: #fff;
            }
            .btn-outline-info {
                color: #0369a1;
                border-color: #0369a1;
            }
            .btn-outline-info:hover {
                background-color: #0369a1;
                border-color: #0369a1;
                color: #fff;
            }
            .hero-title {
                color: var(--text-primary);
                font-weight: bold;
                font-size: 2.5rem;
                margin-bottom: 0.5rem;
                letter-spacing: -0.5px;
            }
            .header-controls {
                display: flex;
                justify-content: flex-end;
                align-items: center;
                gap: 12px;
                margin-bottom: 0.5rem;
            }
            .link-icon {
                text-decoration: none;
                padding: 4px 8px;
                background: var(--bg-secondary);
                border: 1px solid var(--border-color);
                color: var(--text-secondary);
                font-size: 12px;
                margin: 2px;
                display: inline-block;
            }
            .link-icon:hover {
                background: #555;
                border-color: #555;
                color: #fff;
            }
            [data-theme='dark'] .link-icon {
                background: #333;
                border-color: #555;
                color: #ccc;
            }
            [data-theme='dark'] .link-icon:hover {
                background: #666;
                border-color: #666;
                color: #fff;
            }
            .form-control,
            .form-select {
                border-radius: 0;
                border: 1px solid var(--border-color);
                font-size: 13px;
                background-color: var(--bg-primary);
                color: var(--text-primary);
            }
            .form-control:focus,
            .form-select:focus {
                border-color: var(--text-muted);
                box-shadow: none;
                background-color: var(--bg-primary);
                color: var(--text-primary);
            }
            .form-control::placeholder {
                color: var(--text-muted);
            }
            .alert {
                border-radius: 0;
                font-size: 13px;
            }
            .alert-info {
                background-color: #f5f5f5;
                border: 1px solid #ccc;
                color: #333;
            }
            .alert-success {
                background-color: #e8f5e9;
                border: 1px solid #4caf50;
                color: #2e7d32;
            }
            .alert-danger {
                background-color: #ffebee;
                border: 1px solid #f44336;
                color: #c62828;
            }
            .alert-warning {
                background-color: #fff8e1;
                border: 1px solid #ff9800;
                color: #e65100;
            }
            .text-muted {
                color: var(--text-secondary) !important;
            }
            .lead {
                color: var(--text-muted);
                font-size: 12px;
            }
            .theme-toggle {
                background: none;
                border: 1px solid var(--border-color);
                padding: 4px 8px;
                font-size: 14px;
                cursor: pointer;
                border-radius: 0;
            }
            .theme-toggle:hover {
                background: var(--bg-secondary);
            }
            .drop-zone {
                position: relative;
                border: 1px dashed #999;
                transition: all 0.2s ease;
                cursor: pointer;
            }
            .drop-zone:hover {
                border-color: #333;
                background-color: #fafafa;
            }
            .drop-zone.dragover {
                border-color: #333;
                background-color: #f0f0f0;
                border-style: solid;
            }
            .modal-content {
                border-radius: 0;
                border: 1px solid var(--border-color);
                background: var(--bg-primary);
                color: var(--text-primary);
            }
            .modal-header {
                background: var(--bg-secondary);
                border-bottom: 1px solid var(--border-color);
                padding: 0.75rem 1rem;
            }
            .modal-title {
                font-size: 14px;
                font-weight: 600;
                color: var(--text-primary);
            }
            .modal-body {
                font-size: 13px;
                color: var(--text-primary);
            }
            .modal-body pre {
                background: #1a1a1a;
                color: #f0f0f0;
                padding: 12px;
                font-size: 12px;
                border: none;
                border-radius: 0;
            }
            .modal-body code {
                color: #d63384;
                background: var(--bg-code);
                padding: 1px 4px;
                font-size: 11px;
            }
            .modal-footer {
                border-top: 1px solid var(--border-color);
                padding: 0.5rem 1rem;
            }
            code {
                font-family: monospace;
                font-size: 12px;
            }
            .filter-group {
                display: inline-block;
                position: relative;
                margin-right: 0.5rem;
                vertical-align: top;
            }
            .filter-group-header {
                display: inline-flex;
                align-items: center;
                gap: 4px;
                padding: 4px 10px;
                font-size: 11px;
                cursor: pointer;
                background: var(--bg-secondary);
                border: 1px solid var(--border-color);
                border-radius: 4px;
                color: var(--text-secondary);
                transition: all 0.15s ease;
            }
            .filter-group-header:hover {
                border-color: var(--text-muted);
                color: var(--text-primary);
                background: var(--bg-primary);
            }
            .filter-group-header .filter-group-label {
                font-weight: 500;
                color: var(--text-muted);
            }
            .filter-group-header .filter-group-count {
                font-size: 10px;
                color: var(--text-muted);
                background: var(--bg-primary);
                padding: 1px 5px;
                border-radius: 8px;
                min-width: 18px;
                text-align: center;
            }
            .filter-group-header.has-active {
                border-color: var(--text-primary);
                background: var(--text-primary);
                color: var(--bg-primary);
            }
            .filter-group-header.has-active .filter-group-label,
            .filter-group-header.has-active .filter-group-count {
                color: var(--bg-primary);
                background: transparent;
            }
            .filter-group-dropdown {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                padding-top: 4px;
                z-index: 50;
            }
            .filter-group-dropdown-inner {
                background: var(--bg-primary);
                border: 1px solid var(--border-color);
                border-radius: 4px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
                min-width: 140px;
                max-height: 220px;
                overflow-y: auto;
                padding: 4px 0;
            }
            .filter-group:hover .filter-group-dropdown {
                display: block;
            }
            .filter-tag {
                display: block;
                padding: 5px 12px;
                font-size: 11px;
                cursor: pointer;
                color: var(--text-secondary);
                transition: background 0.1s;
                white-space: nowrap;
            }
            .filter-tag:hover {
                background: var(--bg-secondary);
                color: var(--text-primary);
            }
            .filter-tag.active {
                background: var(--text-primary);
                color: var(--bg-primary);
            }
            .filter-tag.active:hover {
                opacity: 0.9;
            }
            /* Dark mode graph text fix */
            [data-theme='dark'] #graph text,
            [data-theme='dark'] #splash-graph text,
            [data-theme='dark'] #attribute-graph text {
                fill: #e0e0e0 !important;
            }
            [data-theme='dark'] #graph .node text,
            [data-theme='dark'] #splash-graph .node text,
            [data-theme='dark'] #attribute-graph .node text {
                fill: #1a1a1a !important;
            }
            /* Preserve schedule magenta color in nodes */
            [data-theme='dark'] #graph .node text[fill='#d63384'],
            [data-theme='dark'] #splash-graph .node text[fill='#d63384'],
            #graph .node text[fill='#d63384'],
            #splash-graph .node text[fill='#d63384'] {
                fill: #d63384 !important;
            }
            [data-theme='dark'] #graph .graph > polygon,
            [data-theme='dark'] #splash-graph .graph > polygon,
            [data-theme='dark'] #attribute-graph .graph > polygon {
                fill: transparent !important;
            }
            [data-theme='dark'] #graph .cluster > polygon,
            [data-theme='dark'] #graph .cluster > path,
            [data-theme='dark'] #attribute-graph .cluster > polygon,
            [data-theme='dark'] #attribute-graph .cluster > path {
                fill: #2a2a2a !important;
                stroke: #555 !important;
            }
            [data-theme='dark'] #graph .cluster text,
            [data-theme='dark'] #attribute-graph .cluster text {
                fill: #e0e0e0 !important;
            }
            /* Dark mode Bootstrap table overrides */
            [data-theme='dark'] .table {
                --bs-table-bg: var(--bg-primary);
                --bs-table-striped-bg: var(--bg-secondary);
                --bs-table-hover-bg: #333;
                --bs-table-color: var(--text-primary);
                --bs-table-striped-color: var(--text-primary);
                --bs-table-hover-color: var(--text-primary);
                color: var(--text-primary);
                border-color: var(--border-color);
            }
            [data-theme='dark'] .table > :not(caption) > * > * {
                background-color: var(--bg-primary);
                color: var(--text-primary);
                border-bottom-color: var(--border-light);
            }
            [data-theme='dark'] .table-striped > tbody > tr:nth-of-type(odd) > * {
                background-color: var(--bg-secondary);
            }
            [data-theme='dark'] .table th {
                background-color: #252525 !important;
                color: #e0e0e0 !important;
            }
            /* Dark mode for table link buttons */
            [data-theme='dark'] .table .btn-outline-primary {
                border-color: #666;
                color: #aaa;
            }
            [data-theme='dark'] .table .btn-outline-primary:hover {
                background-color: #555;
                border-color: #555;
                color: #fff;
            }
            /* Hero fade-in animations */
            @keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateY(12px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            .hero-animate {
                opacity: 0;
                animation: fadeInUp 0.5s ease-out forwards;
            }
            .hero-animate-1 {
                animation-delay: 0.1s;
            }
            .hero-animate-2 {
                animation-delay: 0.3s;
            }
            .hero-animate-3 {
                animation-delay: 0.5s;
            }
            .hero-animate-4 {
                animation-delay: 0.7s;
            }
            /* Feature tiles grid */
            .feature-grid {
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                gap: 1rem;
                margin-bottom: 2.5rem;
            }
            .superpowers-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem 1.5rem;
                font-size: 13px;
                color: var(--text-secondary);
                line-height: 1.5;
            }
            @media (max-width: 992px) {
                .feature-grid {
                    grid-template-columns: repeat(2, 1fr);
                }
            }
            @media (max-width: 576px) {
                .feature-grid {
                    grid-template-columns: 1fr;
                }
                .superpowers-grid {
                    grid-template-columns: 1fr;
                }
            }
            /* Feature tiles */
            .feature-tile {
                padding: 0.875rem;
                background: var(--bg-secondary);
            }
            @media (max-width: 576px) {
                .feature-tile {
                    padding: 1rem 1.25rem;
                }
            }
            .feature-icon {
                color: var(--text-muted);
                margin-bottom: 0.5rem;
            }

            /* Stats Tab */
            .stats-summary {
                display: flex;
                gap: 1.5rem;
                font-size: 13px;
                color: var(--text-secondary);
                margin-bottom: 1.5rem;
                padding-bottom: 1rem;
                border-bottom: 1px solid var(--border-light);
            }
            .stats-summary strong {
                color: var(--text-primary);
                font-weight: 600;
            }
            .stats-row {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1.5rem;
                margin-bottom: 1.5rem;
            }
            @media (max-width: 768px) {
                .stats-row {
                    grid-template-columns: 1fr;
                }
            }
            .stats-section {
                margin-bottom: 1.5rem;
            }
            .stats-section.all-good {
                color: #2e7d32;
            }
            .section-title {
                font-size: 10px;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                color: var(--text-muted);
                margin-bottom: 0.5rem;
                padding-bottom: 0.25rem;
                border-bottom: 1px solid var(--border-light);
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }
            .section-hint {
                font-weight: 400;
                text-transform: none;
                letter-spacing: 0;
            }
            .chart-box {
                padding: 0;
            }
            .chart-title {
                font-size: 10px;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                color: var(--text-muted);
                margin-bottom: 0.5rem;
                padding-bottom: 0.25rem;
                border-bottom: 1px solid var(--border-light);
            }

            /* Pie Charts */
            .pie-container {
                display: flex;
                align-items: flex-start;
                gap: 0.75rem;
            }
            .pie-container svg {
                flex-shrink: 0;
            }
            .pie-legend {
                flex: 1;
                font-family: 'SF Mono', Monaco, monospace;
                font-size: 10px;
            }
            .pie-legend-row {
                display: flex;
                align-items: center;
                gap: 0.4rem;
                padding: 0.15rem 0;
            }
            .pie-legend-dot {
                width: 8px;
                height: 8px;
                flex-shrink: 0;
            }
            .pie-legend-name {
                flex: 1;
                color: var(--text-secondary);
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
            }
            .pie-legend-val {
                color: var(--text-muted);
            }

            /* Coverage Bars */
            .coverage-bars {
                display: flex;
                flex-direction: column;
                gap: 0.5rem;
            }
            .coverage-row {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                font-size: 11px;
            }
            .coverage-row .coverage-label {
                min-width: 80px;
                color: var(--text-secondary);
            }
            .coverage-bar-wrap {
                flex: 1;
                height: 6px;
                background: var(--border-light);
                border-radius: 1px;
            }
            .coverage-bar-wrap .coverage-bar {
                height: 100%;
                border-radius: 1px;
            }
            .coverage-bar-wrap .coverage-bar.good {
                background: #7cb47c;
            }
            .coverage-bar-wrap .coverage-bar.okay {
                background: #d4a574;
            }
            .coverage-bar-wrap .coverage-bar.low {
                background: #c98b8b;
            }
            .coverage-pct {
                font-family: 'SF Mono', Monaco, monospace;
                min-width: 32px;
                text-align: right;
            }
            .coverage-pct.good {
                color: #5a9a5a;
            }
            .coverage-pct.okay {
                color: #b8885a;
            }
            .coverage-pct.low {
                color: #a86b6b;
            }

            /* Hubs */
            .hub-list {
                font-family: 'SF Mono', Monaco, monospace;
                font-size: 11px;
                max-height: 150px;
                overflow-y: auto;
            }
            .hub-row {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                padding: 0.25rem 0;
                border-bottom: 1px dotted var(--border-light);
            }
            .hub-row:last-child {
                border-bottom: none;
            }
            .hub-rank {
                font-size: 10px;
                color: var(--text-muted);
                min-width: 14px;
            }
            .hub-name {
                flex: 1;
                color: var(--text-primary);
            }
            .hub-name.pipeline {
                color: #e65100;
            }
            .hub-name.datasource {
                color: #7b1fa2;
            }
            .hub-name.group {
                color: #00838f;
            }
            .hub-stats {
                font-size: 10px;
                color: var(--text-muted);
            }

            /* Critical Path - Gantt-style */
            .critical-path-section {
                background: transparent;
                border-left: 3px solid #d63384;
                padding: 8px 0 8px 12px;
                margin-bottom: 12px;
            }
            .critical-path-section .section-title {
                color: var(--text-primary);
                font-size: 11px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                margin-bottom: 8px;
            }
            .critical-path-summary {
                display: flex;
                gap: 16px;
                margin-bottom: 12px;
                font-size: 11px;
                font-family: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
            }
            .cp-stat {
                display: flex;
                flex-direction: column;
                gap: 1px;
            }
            .cp-stat-value {
                color: #d63384;
                font-weight: 600;
            }
            .cp-stat-label {
                color: var(--text-muted);
                font-size: 9px;
            }
            .cp-coverage {
                color: var(--text-muted);
                align-self: center;
            }
            .critical-path-gantt {
                display: flex;
                flex-direction: column;
                gap: 3px;
            }
            .cp-bar-row {
                display: flex;
                align-items: center;
                gap: 8px;
            }
            .cp-bar-label {
                font-size: 10px;
                font-family: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
                color: var(--text-secondary);
                width: 140px;
                text-align: right;
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
            }
            .cp-bar-track {
                flex: 1;
                height: 16px;
                background: var(--border-color);
                position: relative;
            }
            .cp-bar-fill {
                position: absolute;
                height: 100%;
                background: linear-gradient(90deg, #f8bbd9 0%, #f48fb1 100%);
                display: flex;
                align-items: center;
                justify-content: flex-end;
                padding-right: 4px;
                min-width: 24px;
            }
            .cp-bar-duration {
                font-size: 9px;
                font-family: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
                color: #880e4f;
                font-weight: 500;
            }
            .cp-bar-cost {
                font-size: 9px;
                font-family: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
                color: var(--text-muted);
                width: 60px;
                text-align: right;
            }
            .cp-bar-time {
                font-size: 9px;
                font-family: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
                color: var(--text-muted);
                width: 50px;
                text-align: right;
            }
            [data-theme='dark'] .critical-path-section {
                border-left-color: #f48fb1;
            }
            [data-theme='dark'] .cp-stat-value {
                color: #f48fb1;
            }
            [data-theme='dark'] .cp-bar-fill {
                background: linear-gradient(90deg, #ad1457 0%, #d63384 100%);
            }
            [data-theme='dark'] .cp-bar-duration {
                color: #fff;
            }

            /* Costliest Path */
            .costliest-path-section {
                background: transparent;
                border-left: 3px solid #66bb6a;
                padding: 8px 0 8px 12px;
                margin-bottom: 12px;
            }
            [data-theme='dark'] .costliest-path-section {
                border-left-color: #81c784;
            }

            /* Cycles */
            .stats-section.cycles-warning {
                background: rgba(183, 28, 28, 0.08);
                border: 1px solid #c98b8b;
                border-radius: 4px;
                padding: 12px;
            }
            .stats-section.cycles-warning .section-title {
                color: #b71c1c;
            }
            .cycle-count {
                background: #c98b8b;
                color: #fff;
                padding: 1px 6px;
                border-radius: 8px;
                font-size: 9px;
                margin-left: 6px;
            }
            .cycle-list {
                margin-top: 10px;
                font-family: 'SF Mono', Monaco, monospace;
                font-size: 11px;
            }
            .cycle-item {
                display: flex;
                gap: 10px;
                padding: 6px 0;
                border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            }
            .cycle-item:last-child {
                border-bottom: none;
            }
            .cycle-label {
                color: #b71c1c;
                font-weight: 600;
                white-space: nowrap;
            }
            .cycle-path {
                color: #555;
                word-break: break-word;
            }
            [data-theme='dark'] .stats-section.cycles-warning {
                background: rgba(183, 28, 28, 0.15);
                border-color: #c98b8b;
            }
            [data-theme='dark'] .stats-section.cycles-warning .section-title {
                color: #ef9a9a;
            }
            [data-theme='dark'] .cycle-label {
                color: #ef9a9a;
            }
            [data-theme='dark'] .cycle-path {
                color: #aaa;
            }

            /* Missing/Needs Attention */
            .missing-scroll {
                max-height: 250px;
                overflow-y: auto;
                padding-right: 0.5rem;
            }
            .missing-block {
                margin-bottom: 0.75rem;
            }
            .missing-block:last-child {
                margin-bottom: 0;
            }
            .missing-header {
                font-size: 11px;
                color: var(--text-muted);
                margin-bottom: 0.25rem;
                display: flex;
                align-items: center;
                gap: 0.4rem;
            }
            .missing-count {
                font-family: 'SF Mono', Monaco, monospace;
                font-size: 10px;
                background: var(--bg-secondary);
                padding: 1px 5px;
            }
            .missing-names {
                font-family: 'SF Mono', Monaco, monospace;
                font-size: 11px;
                line-height: 1.6;
                word-break: break-word;
            }
            .missing-names.pipeline {
                color: #e65100;
            }
            .missing-names.datasource {
                color: #7b1fa2;
            }
            .missing-names.orphan {
                color: #c62828;
            }
            [data-theme='dark'] .missing-names.orphan {
                color: #ef9a9a;
            }
            [data-theme='dark'] .missing-names.pipeline {
                color: #ffab91;
            }
            [data-theme='dark'] .missing-names.datasource {
                color: #ce93d8;
            }

            /* Scrollbars */
            .hub-list::-webkit-scrollbar,
            .missing-scroll::-webkit-scrollbar {
                width: 4px;
            }
            .hub-list::-webkit-scrollbar-track,
            .missing-scroll::-webkit-scrollbar-track {
                background: var(--bg-secondary);
            }
            .hub-list::-webkit-scrollbar-thumb,
            .missing-scroll::-webkit-scrollbar-thumb {
                background: var(--border-color);
                border-radius: 2px;
            }
            .hub-list::-webkit-scrollbar-thumb:hover,
            .missing-scroll::-webkit-scrollbar-thumb:hover {
                background: var(--text-muted);
            }
        </style>
    </head>
    <body>
        <div class="container-fluid py-4">
            <div class="hero-section">
                <div class="mb-4 text-center position-relative">
                    <div class="header-controls">
                        <a
                            href="https://github.com/mattlianje/pipeviz"
                            target="_blank"
                            style="color: var(--text-muted); font-size: 13px; text-decoration: none; display: inline-flex; align-items: center; gap: 4px;"
                            title="GitHub"
                            ><svg height="14" width="14" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg>GitHub</a
                        >
                        <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark mode" id="theme-toggle">
                            
                        </button>
                    </div>
                    <h1 class="hero-title">
                        <img
                            src="https://raw.githubusercontent.com/mattlianje/d4/master/pix/pipeviz.png"
                            alt="Pipeviz logo"
                            style="height: 1.2em; vertical-align: middle; margin-right: 0.25rem"
                        />
                        Pipeviz
                    </h1>
                    <p class="lead">Easy, elegant lineage from a single <span style="color: #d63384">.json</span></p>
                </div>

                <ul class="nav nav-tabs hidden-on-home" id="dashboardTabs">
                    <!-- Start -->
                    <li class="nav-item">
                        <button
                            class="nav-link active"
                            id="home-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#home-pane"
                            title="Welcome &amp; quick start"
                        >
                            Home
                        </button>
                    </li>
                    <li class="nav-item">
                        <button
                            class="nav-link"
                            id="config-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#config-pane"
                            title="View and edit your JSON config"
                        >
                            Config
                        </button>
                    </li>
                    <li class="nav-item nav-separator"></li>
                    <!-- Visualize -->
                    <li class="nav-item">
                        <button
                            class="nav-link"
                            id="graph-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#graph-pane"
                            title="Pipeline dependency graph"
                        >
                            Graph
                        </button>
                    </li>
                    <li class="nav-item">
                        <button
                            class="nav-link"
                            id="attributes-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#attributes-pane"
                            title="Column-level lineage"
                        >
                            Attributes
                        </button>
                    </li>
                    <li class="nav-item nav-separator"></li>
                    <!-- Browse -->
                    <li class="nav-item">
                        <button
                            class="nav-link"
                            id="pipelines-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#pipelines-pane"
                            title="Browse all pipelines"
                        >
                            Pipelines
                        </button>
                    </li>
                    <li class="nav-item">
                        <button
                            class="nav-link"
                            id="datasources-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#datasources-pane"
                            title="Browse all datasources"
                        >
                            Datasources
                        </button>
                    </li>
                    <li class="nav-item nav-separator"></li>
                    <!-- Tools -->
                    <li class="nav-item">
                        <button
                            class="nav-link"
                            id="export-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#export-pane"
                            title="Export as JSON, Mermaid, or DOT"
                        >
                            Export
                        </button>
                    </li>
                    <li class="nav-item">
                        <button
                            class="nav-link"
                            id="backfill-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#backfill-pane"
                            title="Plan downstream execution order"
                        >
                            Planner
                        </button>
                    </li>
                    <li class="nav-item">
                        <button
                            class="nav-link"
                            id="stats-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#stats-pane"
                            title="Pipeline statistics and health"
                        >
                            Stats
                        </button>
                    </li>
                    <li class="nav-item">
                        <button
                            class="nav-link"
                            id="merge-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#merge-pane"
                            title="Merge configs with jq"
                        >
                            Merge
                        </button>
                    </li>
                    <li class="nav-item nav-separator"></li>
                    <!-- Reference -->
                    <li class="nav-item">
                        <button
                            class="nav-link"
                            id="spec-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#spec-pane"
                            title="JSON specification reference"
                        >
                            Spec
                        </button>
                    </li>
                </ul>

                <div class="tab-content">
                    <!-- Home Tab -->
                    <div class="tab-pane fade show active" id="home-pane">
                        <div style="max-width: 750px; margin: 0 auto; padding: 2rem 1rem">
                            <!-- Intro -->
                            <p
                                style="
                                    font-size: 14px;
                                    color: var(--text-secondary);
                                    line-height: 1.7;
                                    margin-bottom: 1.5rem;
                                "
                            >
                                An open source JSON spec for lineage. Declare your pipelines, get beautiful graphs.
                            </p>

                            <!-- Demo -->
                            <div
                                style="
                                    display: flex;
                                    gap: 1.5rem;
                                    align-items: center;
                                    justify-content: center;
                                    flex-wrap: wrap;
                                    margin-bottom: 2rem;
                                "
                            >
                                <pre
                                    class="hero-animate hero-animate-1"
                                    style="padding: 1rem; font-size: 13px; margin: 0; color: var(--text-primary)"
                                >
{
  "pipelines": [{
    "name": "etl-job",
    "input_sources": ["raw_events"],
    "output_sources": ["cleaned_events"]
  }]
}</pre
                                >
                                <svg
                                    class="hero-animate hero-animate-2"
                                    width="24"
                                    height="24"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="1.5"
                                    style="color: var(--text-muted); flex-shrink: 0"
                                >
                                    <path d="M5 12h14M13 5l7 7-7 7" />
                                </svg>
                                <div
                                    id="splash-graph"
                                    class="hero-animate hero-animate-3"
                                    style="
                                        min-width: 240px;
                                        min-height: 120px;
                                        display: flex;
                                        align-items: center;
                                        justify-content: center;
                                    "
                                ></div>
                            </div>

                            <!-- Buttons -->
                            <div
                                class="hero-animate hero-animate-4"
                                style="display: flex; gap: 0.75rem; justify-content: center; margin-bottom: 2.5rem"
                            >
                                <button
                                    class="btn btn-dark"
                                    onclick="
                                        loadExample()
                                        document.getElementById('graph-tab').click()
                                    "
                                >
                                    Try demo
                                </button>
                                <button
                                    class="btn btn-outline-secondary"
                                    onclick="document.getElementById('spec-tab').click()"
                                >
                                    Read spec
                                </button>
                            </div>

                            <!-- Feature tiles -->
                            <div class="feature-grid" style="margin-bottom: 2rem">
                                <div class="feature-tile">
                                    <svg
                                        width="16"
                                        height="16"
                                        viewBox="0 0 24 24"
                                        fill="none"
                                        stroke="currentColor"
                                        stroke-width="1.5"
                                        class="feature-icon"
                                    >
                                        <rect x="4" y="4" width="6" height="6" rx="1" />
                                        <rect x="14" y="4" width="6" height="6" rx="1" />
                                        <rect x="4" y="14" width="6" height="6" rx="1" />
                                        <rect x="14" y="14" width="6" height="6" rx="1" />
                                    </svg>
                                    <div
                                        style="
                                            font-size: 12px;
                                            color: var(--text-primary);
                                            font-weight: 600;
                                            margin-bottom: 0.2rem;
                                        "
                                    >
                                        Stack Agnostic
                                    </div>
                                    <div style="font-size: 12px; color: var(--text-secondary); line-height: 1.4">
                                        SQL, Spark, Kafka, APIs, shell scripts. Just JSON.
                                    </div>
                                </div>
                                <div class="feature-tile">
                                    <svg
                                        width="16"
                                        height="16"
                                        viewBox="0 0 24 24"
                                        fill="none"
                                        stroke="currentColor"
                                        stroke-width="1.5"
                                        class="feature-icon"
                                    >
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                                        <polyline points="14 2 14 8 20 8" />
                                    </svg>
                                    <div
                                        style="
                                            font-size: 12px;
                                            color: var(--text-primary);
                                            font-weight: 600;
                                            margin-bottom: 0.2rem;
                                        "
                                    >
                                        Zero Dependencies
                                    </div>
                                    <div style="font-size: 12px; color: var(--text-secondary); line-height: 1.4">
                                        One HTML file. No backend, no build step. Host anywhere.
                                    </div>
                                </div>
                                <div class="feature-tile">
                                    <svg
                                        width="16"
                                        height="16"
                                        viewBox="0 0 24 24"
                                        fill="none"
                                        stroke="currentColor"
                                        stroke-width="1.5"
                                        class="feature-icon"
                                    >
                                        <circle cx="6" cy="6" r="3" />
                                        <circle cx="18" cy="6" r="3" />
                                        <circle cx="6" cy="18" r="3" />
                                        <circle cx="18" cy="18" r="3" />
                                        <path d="M6 9v6m12-6v6M9 6h6m-6 12h6" />
                                    </svg>
                                    <div
                                        style="
                                            font-size: 12px;
                                            color: var(--text-primary);
                                            font-weight: 600;
                                            margin-bottom: 0.2rem;
                                        "
                                    >
                                        Federated
                                    </div>
                                    <div style="font-size: 12px; color: var(--text-secondary); line-height: 1.4">
                                        Each team owns their JSON. Merge with jq for the org-wide view.
                                    </div>
                                </div>
                                <div class="feature-tile">
                                    <svg
                                        width="16"
                                        height="16"
                                        viewBox="0 0 24 24"
                                        fill="none"
                                        stroke="currentColor"
                                        stroke-width="1.5"
                                        class="feature-icon"
                                    >
                                        <path d="M3 6h18M3 12h18M3 18h18" />
                                        <circle cx="7" cy="6" r="1.5" fill="currentColor" />
                                        <circle cx="14" cy="12" r="1.5" fill="currentColor" />
                                        <circle cx="10" cy="18" r="1.5" fill="currentColor" />
                                    </svg>
                                    <div
                                        style="
                                            font-size: 12px;
                                            color: var(--text-primary);
                                            font-weight: 600;
                                            margin-bottom: 0.2rem;
                                        "
                                    >
                                        Column-Level Lineage
                                    </div>
                                    <div style="font-size: 12px; color: var(--text-secondary); line-height: 1.4">
                                        Track field-level provenance. See where each attribute comes from.
                                    </div>
                                </div>
                            </div>

                            <!-- How it works -->
                            <div style="margin-bottom: 2rem">
                                <div
                                    style="
                                        font-size: 12px;
                                        font-weight: 600;
                                        margin-bottom: 0.75rem;
                                        color: var(--text-muted);
                                        text-transform: uppercase;
                                        letter-spacing: 0.5px;
                                    "
                                >
                                    How it works
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; gap: 1.5rem; flex-wrap: wrap"
                                >
                                    <div style="flex: 1; min-width: 140px; text-align: center">
                                        <div
                                            style="font-size: 1.25rem; color: var(--text-muted); margin-bottom: 0.2rem"
                                        >
                                            1
                                        </div>
                                        <div
                                            style="
                                                font-size: 12px;
                                                font-weight: 600;
                                                color: var(--text-primary);
                                                margin-bottom: 0.2rem;
                                            "
                                        >
                                            Define
                                        </div>
                                        <div style="font-size: 13px; color: var(--text-secondary); line-height: 1.4">
                                            Write a <code>pipeviz.json</code> describing your pipelines and data sources
                                        </div>
                                    </div>
                                    <div style="flex: 1; min-width: 140px; text-align: center">
                                        <div
                                            style="font-size: 1.25rem; color: var(--text-muted); margin-bottom: 0.2rem"
                                        >
                                            2
                                        </div>
                                        <div
                                            style="
                                                font-size: 12px;
                                                font-weight: 600;
                                                color: var(--text-primary);
                                                margin-bottom: 0.2rem;
                                            "
                                        >
                                            Load
                                        </div>
                                        <div style="font-size: 13px; color: var(--text-secondary); line-height: 1.4">
                                            Drop your file here, or host both files together on any static server
                                        </div>
                                    </div>
                                    <div style="flex: 1; min-width: 140px; text-align: center">
                                        <div
                                            style="font-size: 1.25rem; color: var(--text-muted); margin-bottom: 0.2rem"
                                        >
                                            3
                                        </div>
                                        <div
                                            style="
                                                font-size: 12px;
                                                font-weight: 600;
                                                color: var(--text-primary);
                                                margin-bottom: 0.2rem;
                                            "
                                        >
                                            Explore
                                        </div>
                                        <div style="font-size: 13px; color: var(--text-secondary); line-height: 1.4">
                                            Click through the graph, trace dependencies, export DOT for other tools
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Superpowers -->
                            <div style="margin-bottom: 2rem">
                                <div
                                    style="
                                        font-size: 12px;
                                        font-weight: 600;
                                        margin-bottom: 0.5rem;
                                        color: var(--text-muted);
                                        text-transform: uppercase;
                                        letter-spacing: 0.5px;
                                    "
                                >
                                    Superpowers
                                </div>
                                <p
                                    style="
                                        font-size: 13px;
                                        color: var(--text-secondary);
                                        line-height: 1.5;
                                        margin: 0 0 1rem 0;
                                    "
                                >
                                    Each pipeline declares what it reads and writes. Pipeviz stitches these into a
                                    complete graph. From there, you get some superpowers for free:
                                </p>
                                <div class="superpowers-grid">
                                    <div style="display: flex; gap: 0.5rem; align-items: flex-start">
                                        <svg
                                            width="16"
                                            height="16"
                                            viewBox="0 0 24 24"
                                            fill="none"
                                            stroke="currentColor"
                                            stroke-width="1.5"
                                            style="flex-shrink: 0; margin-top: 2px"
                                        >
                                            <path d="M4 6h4M4 12h6M4 18h8" />
                                            <path d="M14 6h6M12 12h8M10 18h10" />
                                        </svg>
                                        <span
                                            ><strong style="color: var(--text-primary)">Parallelize backfills</strong>
                                            by topologically sorting nodes into stages. Independent pipelines run
                                            together.</span
                                        >
                                    </div>
                                    <div style="display: flex; gap: 0.5rem; align-items: flex-start">
                                        <svg
                                            width="16"
                                            height="16"
                                            viewBox="0 0 24 24"
                                            fill="none"
                                            stroke="currentColor"
                                            stroke-width="1.5"
                                            style="flex-shrink: 0; margin-top: 2px"
                                        >
                                            <circle cx="12" cy="12" r="9" />
                                            <path d="M12 8v4l2 2" />
                                        </svg>
                                        <span
                                            ><strong style="color: var(--text-primary)"
                                                >Detect circular dependencies</strong
                                            >
                                            before they break your backfill. Cycles shown in red.</span
                                        >
                                    </div>
                                    <div style="display: flex; gap: 0.5rem; align-items: flex-start">
                                        <svg
                                            width="16"
                                            height="16"
                                            viewBox="0 0 24 24"
                                            fill="none"
                                            stroke="currentColor"
                                            stroke-width="1.5"
                                            style="flex-shrink: 0; margin-top: 2px"
                                        >
                                            <path d="M12 2l8 10-8 10-8-10z" />
                                        </svg>
                                        <span
                                            ><strong style="color: var(--text-primary)"
                                                >Handle diamond dependencies</strong
                                            >
                                            correctly. Each node runs only after all its parents complete.</span
                                        >
                                    </div>
                                    <div style="display: flex; gap: 0.5rem; align-items: flex-start">
                                        <svg
                                            width="16"
                                            height="16"
                                            viewBox="0 0 24 24"
                                            fill="none"
                                            stroke="currentColor"
                                            stroke-width="1.5"
                                            style="flex-shrink: 0; margin-top: 2px"
                                        >
                                            <circle cx="12" cy="12" r="10" />
                                            <circle cx="12" cy="12" r="4" />
                                        </svg>
                                        <span
                                            ><strong style="color: var(--text-primary)">Trace blast radius</strong>
                                            downstream from any node. Know exactly what breaks.</span
                                        >
                                    </div>
                                    <div style="display: flex; gap: 0.5rem; align-items: flex-start">
                                        <svg
                                            width="16"
                                            height="16"
                                            viewBox="0 0 24 24"
                                            fill="none"
                                            stroke="currentColor"
                                            stroke-width="1.5"
                                            style="flex-shrink: 0; margin-top: 2px"
                                        >
                                            <path d="M4 17l6-6-6-6" />
                                            <path d="M12 19h8" />
                                        </svg>
                                        <span
                                            ><strong style="color: var(--text-primary)">Export to Mermaid</strong> and
                                            embed diagrams in CI/CD, PRs, or docs.</span
                                        >
                                    </div>
                                    <div style="display: flex; gap: 0.5rem; align-items: flex-start">
                                        <svg
                                            width="16"
                                            height="16"
                                            viewBox="0 0 24 24"
                                            fill="none"
                                            stroke="currentColor"
                                            stroke-width="1.5"
                                            style="flex-shrink: 0; margin-top: 2px"
                                        >
                                            <rect x="4" y="4" width="16" height="16" rx="2" />
                                            <path d="M9 9h6M9 12h6M9 15h4" />
                                        </svg>
                                        <span
                                            ><strong style="color: var(--text-primary)">Build MCPs</strong> on top of
                                            your graph. LLMs can query your lineage.</span
                                        >
                                    </div>
                                    <div style="display: flex; gap: 0.5rem; align-items: flex-start">
                                        <svg
                                            width="16"
                                            height="16"
                                            viewBox="0 0 24 24"
                                            fill="none"
                                            stroke="currentColor"
                                            stroke-width="1.5"
                                            style="flex-shrink: 0; margin-top: 2px"
                                        >
                                            <path d="M3 12h4l3-9 4 18 3-9h4" />
                                        </svg>
                                        <span
                                            ><strong style="color: var(--text-primary)">Find critical path</strong> via
                                            PERT analysis. Know your pipeline's true bottleneck.</span
                                        >
                                    </div>
                                    <div style="display: flex; gap: 0.5rem; align-items: flex-start">
                                        <svg
                                            width="16"
                                            height="16"
                                            viewBox="0 0 24 24"
                                            fill="none"
                                            stroke="currentColor"
                                            stroke-width="1.5"
                                            style="flex-shrink: 0; margin-top: 2px"
                                        >
                                            <path d="M12 2v20M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6" />
                                        </svg>
                                        <span
                                            ><strong style="color: var(--text-primary)">Track spend</strong> per node
                                            and path. See where your compute budget goes.</span
                                        >
                                    </div>
                                </div>
                            </div>

                            <!-- Motivation -->
                            <div style="margin-bottom: 2rem">
                                <div
                                    style="
                                        font-size: 12px;
                                        font-weight: 600;
                                        margin-bottom: 0.5rem;
                                        color: var(--text-muted);
                                        text-transform: uppercase;
                                        letter-spacing: 0.5px;
                                    "
                                >
                                    Why
                                </div>
                                <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.6; margin: 0">
                                    <a
                                        href="https://openlineage.io/"
                                        target="_blank"
                                        style="color: var(--text-secondary)"
                                        >OpenLineage</a
                                    >/<a
                                        href="https://marquezproject.ai/"
                                        target="_blank"
                                        style="color: var(--text-secondary)"
                                        >Marquez</a
                                    >
                                    need agents, a metadata store, scheduler integration.
                                    <a
                                        href="https://atlas.apache.org/"
                                        target="_blank"
                                        style="color: var(--text-secondary)"
                                        >Atlas</a
                                    >
                                    wants a governance platform.
                                    <a
                                        href="https://www.getdbt.com/"
                                        target="_blank"
                                        style="color: var(--text-secondary)"
                                        >dbt</a
                                    >
                                    couples you to their framework. Pipeviz needs one JSON file.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Configuration Tab -->
                    <div class="tab-pane fade" id="config-pane">
                        <div style="max-width: 900px; padding: 1rem 0">
                            <div class="drop-zone" id="drop-zone">
                                <textarea
                                    class="form-control json-editor"
                                    id="json-input"
                                    rows="22"
                                    placeholder="Paste JSON here or drag & drop a file"
                                ></textarea>
                            </div>
                            <div
                                style="
                                    display: flex;
                                    gap: 0.5rem;
                                    align-items: center;
                                    flex-wrap: wrap;
                                    margin-top: 0.75rem;
                                "
                            >
                                <input
                                    type="file"
                                    id="file-input"
                                    accept=".json"
                                    style="display: none"
                                    onchange="loadFromFile(event)"
                                />
                                <button class="graph-ctrl-btn" onclick="document.getElementById('file-input').click()">
                                    Browse
                                </button>
                                <button class="graph-ctrl-btn" onclick="loadExample()">Load Example</button>
                                <button class="graph-ctrl-btn" onclick="generateShareableUrl()">Share URL</button>
                                <span style="color: var(--text-muted); font-size: 12px; margin-left: auto"
                                    >Auto-load: <code style="font-size: 11px">?url=your-json-url</code></span
                                >
                            </div>
                            <div id="json-status" style="margin-top: 0.5rem"></div>
                        </div>
                    </div>

                    <!-- Pipelines Tab -->
                    <div class="tab-pane fade" id="pipelines-pane">
                        <div class="card">
                            <div class="card-body">
                                <div class="mb-3">
                                    <input
                                        type="text"
                                        class="form-control"
                                        id="pipeline-search"
                                        placeholder="Search pipelines..."
                                        onkeyup="filterPipelines()"
                                        style="max-width: 300px"
                                    />
                                </div>
                                <div class="mb-3" id="pipeline-filters"></div>
                                <div id="pipelines-table-container">
                                    <p class="text-muted text-center">Load a configuration to see your pipelines</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Data Sources Tab -->
                    <div class="tab-pane fade" id="datasources-pane">
                        <div class="card">
                            <div class="card-body">
                                <div class="mb-3">
                                    <input
                                        type="text"
                                        class="form-control"
                                        id="datasource-search"
                                        placeholder="Search data sources..."
                                        onkeyup="filterDatasources()"
                                        style="max-width: 300px"
                                    />
                                </div>
                                <div class="mb-3" id="datasource-filters"></div>
                                <div id="datasources-table-container">
                                    <p class="text-muted text-center">Load a configuration to see your data sources</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Graph Tab -->
                    <div class="tab-pane fade" id="graph-pane">
                        <div class="card">
                            <div class="card-body">
                                <div class="row mb-3">
                                    <div class="col-md-4">
                                        <div class="position-relative">
                                            <input
                                                type="text"
                                                class="form-control"
                                                id="graph-search"
                                                placeholder="Search nodes..."
                                                onkeydown="searchNodes(event)"
                                            />
                                            <div id="graph-search-results" class="search-results-dropdown"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div id="graph-col" class="col-md-12">
                                        <div class="graph-container position-relative">
                                            <div class="graph-controls">
                                                <button
                                                    class="graph-ctrl-btn active"
                                                    onclick="toggleCollapseAll()"
                                                    id="collapse-all-btn"
                                                >
                                                    Expand All
                                                </button>
                                                <button class="graph-ctrl-btn" onclick="resetGraph()">Reset</button>
                                                <div class="overflow-menu-container ms-auto">
                                                    <button
                                                        class="overflow-menu-btn"
                                                        onclick="toggleOverflowMenu(event)"
                                                    >
                                                        
                                                    </button>
                                                    <div class="overflow-menu" id="graph-overflow-menu">
                                                        <button
                                                            class="overflow-menu-item"
                                                            id="pipelines-only-btn"
                                                            onclick="
                                                                togglePipelinesOnly()
                                                                updateOverflowMenuState()
                                                            "
                                                        >
                                                            Pipelines Only
                                                        </button>
                                                        <div class="overflow-menu-divider"></div>
                                                        <button
                                                            class="overflow-menu-item"
                                                            id="cp-menu-item"
                                                            onclick="toggleAnalysisModeFromMenu('critical-path')"
                                                        >
                                                            Critical Path
                                                        </button>
                                                        <button
                                                            class="overflow-menu-item"
                                                            id="cost-menu-item"
                                                            onclick="toggleCostLabelsFromMenu()"
                                                        >
                                                            Show Costs
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="graph">
                                                <div class="graph-loading text-center py-5 text-muted">
                                                    <div
                                                        class="spinner-border spinner-border-sm me-2"
                                                        role="status"
                                                    ></div>
                                                    Loading graph...
                                                </div>
                                            </div>
                                            <div class="legend">
                                                <div><strong>Legend:</strong></div>
                                                <div> = Pipeline</div>
                                                <div style="color: #00897b"> = Group</div>
                                                <div> = Data Source</div>
                                                <div> = Cluster</div>
                                                <div> = Data flow</div>
                                                <div style="color: #ff6b35"> = Dependency</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4" id="node-details-col" style="display: none">
                                        <div class="node-details-panel" id="node-details-panel">
                                            <div id="node-details-content"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Attributes Tab -->
                    <div class="tab-pane fade" id="attributes-pane">
                        <div class="card">
                            <div class="card-body">
                                <div class="row mb-3">
                                    <div class="col-md-4">
                                        <div class="position-relative">
                                            <input
                                                type="text"
                                                class="form-control"
                                                id="attribute-search"
                                                placeholder="Search attributes..."
                                                onkeydown="searchAttributes(event)"
                                            />
                                            <div id="attribute-search-results" class="search-results-dropdown"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div id="attribute-graph-col" class="col-md-12">
                                        <div class="graph-container position-relative">
                                            <div class="graph-controls">
                                                <button class="graph-ctrl-btn" onclick="resetAttributeGraph()">
                                                    Reset
                                                </button>
                                            </div>
                                            <div id="attribute-graph">
                                                <div class="graph-loading text-center py-5 text-muted">
                                                    <div
                                                        class="spinner-border spinner-border-sm me-2"
                                                        role="status"
                                                    ></div>
                                                    Loading graph...
                                                </div>
                                            </div>
                                            <div class="legend">
                                                <div><strong>Legend:</strong></div>
                                                <div> = Data Source</div>
                                                <div> = Attribute</div>
                                                <div> = Derived from</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4" id="attribute-details-col" style="display: none">
                                        <div class="node-details-panel" id="attribute-details-panel">
                                            <div id="attribute-details-content"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Export Tab -->
                    <div class="tab-pane fade" id="export-pane">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h5 class="mb-0">Export</h5>
                                    <div class="format-toggle">
                                        <button
                                            class="graph-ctrl-btn export-format-btn active"
                                            data-format="json"
                                            onclick="setExportFormat('json')"
                                        >
                                            JSON
                                        </button>
                                        <button
                                            class="graph-ctrl-btn export-format-btn"
                                            data-format="mermaid"
                                            onclick="setExportFormat('mermaid')"
                                        >
                                            Mermaid
                                        </button>
                                        <button
                                            class="graph-ctrl-btn export-format-btn"
                                            data-format="dot"
                                            onclick="setExportFormat('dot')"
                                        >
                                            DOT
                                        </button>
                                    </div>
                                </div>
                                <div class="export-output-container">
                                    <button
                                        class="export-copy-btn"
                                        onclick="copyExportToClipboard(event)"
                                        title="Copy to clipboard"
                                    >
                                        <svg
                                            width="14"
                                            height="14"
                                            viewBox="0 0 24 24"
                                            fill="none"
                                            stroke="currentColor"
                                            stroke-width="2"
                                        >
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                        </svg>
                                    </button>
                                    <pre class="export-output" id="export-output">
Load a configuration to see the graph export...</pre
                                    >
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Backfill Tab -->
                    <div class="tab-pane fade" id="backfill-pane">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h5 class="mb-0">Planner</h5>
                                    <div class="d-flex align-items-center gap-3">
                                        <div class="btn-group btn-group-sm backfill-pipeline-picker">
                                            <div class="backfill-picker-dropdown" id="backfill-picker-dropdown">
                                                <div class="backfill-picker-search">
                                                    <input
                                                        type="text"
                                                        id="backfill-picker-filter"
                                                        placeholder="Filter pipelines..."
                                                        oninput="filterBackfillPipelines(this.value)"
                                                    />
                                                </div>
                                                <div class="backfill-picker-list" id="backfill-picker-list"></div>
                                                <div class="backfill-picker-footer">
                                                    <span id="backfill-picker-count">0 selected</span>
                                                    <button
                                                        class="backfill-picker-clear"
                                                        onclick="clearBackfillSelection()"
                                                    >
                                                        Clear all
                                                    </button>
                                                </div>
                                            </div>
                                            <button
                                                class="graph-ctrl-btn backfill-view-btn active"
                                                data-view="pipeline"
                                                onclick="setBackfillView('pipeline')"
                                            >
                                                Run Order
                                            </button>
                                            <button
                                                class="graph-ctrl-btn backfill-view-btn"
                                                data-view="airflow"
                                                onclick="setBackfillView('airflow')"
                                            >
                                                Airflow DAGs
                                            </button>
                                            <button
                                                class="graph-ctrl-btn backfill-view-btn danger"
                                                data-view="blast"
                                                onclick="setBackfillView('blast')"
                                            >
                                                Blast Radius
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div id="backfill-hint" class="backfill-hint">
                                    Select pipelines to plan backfill execution order
                                </div>
                                <div class="row">
                                    <div class="col-md-7">
                                        <div class="backfill-graph-container">
                                            <div id="backfill-graph" class="backfill-graph">
                                                <div
                                                    style="
                                                        color: var(--text-muted);
                                                        font-size: 12px;
                                                        padding: 2rem;
                                                        text-align: center;
                                                    "
                                                >
                                                    Select pipelines to see the execution plan
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-5">
                                        <div class="export-output-container">
                                            <button
                                                class="export-copy-btn"
                                                onclick="copyBackfillToClipboard(event)"
                                                title="Copy to clipboard"
                                            >
                                                <svg
                                                    width="14"
                                                    height="14"
                                                    viewBox="0 0 24 24"
                                                    fill="none"
                                                    stroke="currentColor"
                                                    stroke-width="2"
                                                >
                                                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                                    <path
                                                        d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"
                                                    ></path>
                                                </svg>
                                            </button>
                                            <pre class="export-output" id="backfill-output" style="height: 450px">
Select a pipeline to see the backfill plan...</pre
                                            >
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Tab -->
                    <div class="tab-pane fade" id="stats-pane">
                        <div class="card">
                            <div class="card-body">
                                <div id="stats-content">
                                    <div class="text-muted">Load a configuration to see statistics.</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Merge Tab -->
                    <div class="tab-pane fade" id="merge-pane">
                        <div style="max-width: 800px; padding: 1rem 0">
                            <h5 style="margin-bottom: 1rem">Merging Pipeviz Configs</h5>
                            <p
                                style="
                                    font-size: 13px;
                                    color: var(--text-secondary);
                                    line-height: 1.6;
                                    margin-bottom: 1.5rem;
                                "
                            >
                                When your data platform spans multiple teams or repositories, you can maintain separate
                                config files and merge them into a single Pipeviz config using <code>jq</code>.
                            </p>

                            <div class="merge-section">
                                <h6>Basic Merge (Two Files)</h6>
                                <p>Combine pipelines and datasources from two config files:</p>
                                <pre class="merge-code"><code>jq -s '{
  pipelines: (.[0].pipelines + .[1].pipelines),
  datasources: (.[0].datasources + .[1].datasources)
}' team_a.json team_b.json > combined.json</code></pre>
                            </div>

                            <div class="merge-section">
                                <h6>Merge Multiple Files</h6>
                                <p>Merge all <code>*.pipeviz.json</code> files in a directory:</p>
                                <pre class="merge-code"><code>jq -s '{
  pipelines: [.[].pipelines[]] | unique_by(.name),
  datasources: [.[].datasources[]] | unique_by(.name)
}' configs/*.pipeviz.json > combined.json</code></pre>
                            </div>

                            <div class="merge-section">
                                <h6>Merge with Deduplication</h6>
                                <p>
                                    When configs might have overlapping definitions, dedupe by name (last write wins):
                                </p>
                                <pre class="merge-code"><code>jq -s '{
  pipelines: (
    [.[].pipelines[]] | group_by(.name) | map(last)
  ),
  datasources: (
    [.[].datasources[]] | group_by(.name) | map(last)
  )
}' *.json > merged.json</code></pre>
                            </div>

                            <div class="merge-section">
                                <h6>Smart Prefix (Only on Collision)</h6>
                                <p>Only add prefixes when names actually collide:</p>
                                <pre class="merge-code"><code># Find colliding names, prefix only those
jq -s '
  # Collect all pipelines with their source file
  [
    (.[0].pipelines | map(. + {_src: "a"})),
    (.[1].pipelines | map(. + {_src: "b"}))
  ] | add
  # Group by name to find collisions
  | group_by(.name)
  | map(
      if length > 1 then
        # Collision: prefix each with source
        map(.name = ._src + "_" + .name)
      else . end
    )
  | add
  | map(del(._src))
' team_a.json team_b.json

# Full merge with collision handling
jq -s '
  def smart_merge(key):
    group_by(.[key]) | map(
      if length > 1 then 
        to_entries | map(.value[key] = "src\(.key)_" + .value[key]) | map(.value)
      else . end
    ) | add;
  {
    pipelines: ([.[].pipelines[]] | smart_merge("name")),
    datasources: ([.[].datasources[]] | smart_merge("name"))
  }
' *.json > merged.json</code></pre>
                            </div>

                            <style>
                                .merge-section {
                                    margin-bottom: 1.5rem;
                                }
                                .merge-section h6 {
                                    font-size: 13px;
                                    font-weight: 600;
                                    margin-bottom: 0.5rem;
                                    color: var(--text-primary);
                                }
                                .merge-section p {
                                    font-size: 12px;
                                    color: var(--text-secondary);
                                    margin-bottom: 0.5rem;
                                }
                                .merge-code {
                                    background: var(--bg-secondary);
                                    border: 1px solid var(--border-color);
                                    border-radius: 4px;
                                    padding: 12px 14px;
                                    font-size: 11px;
                                    line-height: 1.5;
                                    overflow-x: auto;
                                    margin: 0;
                                }
                                .merge-code code {
                                    font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
                                    color: var(--text-primary);
                                }
                            </style>
                        </div>
                    </div>

                    <!-- Spec Tab -->
                    <div class="tab-pane fade" id="spec-pane">
                        <div style="max-width: 800px; padding: 1rem 0">
                            <style>
                                .spec-table {
                                    width: 100%;
                                    border-collapse: collapse;
                                    font-size: 12px;
                                    margin: 0.75rem 0 1rem 0;
                                }
                                .spec-table th,
                                .spec-table td {
                                    padding: 6px 10px;
                                    border: 1px solid var(--border-color);
                                    text-align: left;
                                }
                                .spec-table th {
                                    background: var(--bg-secondary);
                                }
                                .spec-section {
                                    margin-bottom: 2rem;
                                }
                                .spec-section h6 {
                                    font-weight: 600;
                                    margin-bottom: 0.5rem;
                                }
                                .spec-pre {
                                    background: var(--bg-code);
                                    border: 1px solid var(--border-color);
                                    padding: 12px;
                                    font-size: 12px;
                                    color: var(--text-primary);
                                    margin: 0;
                                }
                            </style>

                            <div style="margin-bottom: 1.5rem">
                                <h5 style="font-weight: 600; margin-bottom: 0.25rem">Pipeviz JSON Spec</h5>
                                <p style="color: var(--text-secondary); font-size: 13px">
                                    Only <code>pipelines</code> is required. Clusters and datasources are auto-created
                                    when referenced.
                                </p>
                            </div>

                            <div class="spec-section">
                                <h6>Root</h6>
                                <table class="spec-table">
                                    <tr>
                                        <th>Field</th>
                                        <th>Type</th>
                                        <th>Required</th>
                                        <th>Description</th>
                                    </tr>
                                    <tr>
                                        <td><code>pipelines</code></td>
                                        <td>array</td>
                                        <td>Yes</td>
                                        <td>Jobs that transform or move data</td>
                                    </tr>
                                    <tr>
                                        <td><code>datasources</code></td>
                                        <td>array</td>
                                        <td>No</td>
                                        <td>Tables, files, streams, APIs</td>
                                    </tr>
                                    <tr>
                                        <td><code>clusters</code></td>
                                        <td>array</td>
                                        <td>No</td>
                                        <td>Groups for visual organization</td>
                                    </tr>
                                </table>
                                <pre class="spec-pre">
{
  "clusters": [...],
  "pipelines": [...],
  "datasources": [...]
}</pre
                                >
                            </div>

                            <div class="spec-section">
                                <h6>Pipeline</h6>
                                <table class="spec-table">
                                    <tr>
                                        <th>Field</th>
                                        <th>Type</th>
                                        <th>Required</th>
                                        <th>Description</th>
                                    </tr>
                                    <tr>
                                        <td><code>name</code></td>
                                        <td>string</td>
                                        <td>Yes</td>
                                        <td>Unique identifier</td>
                                    </tr>
                                    <tr>
                                        <td><code>description</code></td>
                                        <td>string</td>
                                        <td>No</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td><code>input_sources</code></td>
                                        <td>array</td>
                                        <td>No</td>
                                        <td>Datasources read from</td>
                                    </tr>
                                    <tr>
                                        <td><code>output_sources</code></td>
                                        <td>array</td>
                                        <td>No</td>
                                        <td>Datasources written to</td>
                                    </tr>
                                    <tr>
                                        <td><code>upstream_pipelines</code></td>
                                        <td>array</td>
                                        <td>No</td>
                                        <td>Pipeline or group names (orange edges)</td>
                                    </tr>
                                    <tr>
                                        <td><code>cluster</code></td>
                                        <td>string</td>
                                        <td>No</td>
                                        <td>Cluster name</td>
                                    </tr>
                                    <tr>
                                        <td><code>group</code></td>
                                        <td>string</td>
                                        <td>No</td>
                                        <td>Collapse into group node</td>
                                    </tr>
                                    <tr>
                                        <td><code>schedule</code></td>
                                        <td>string</td>
                                        <td>No</td>
                                        <td>Free text</td>
                                    </tr>
                                    <tr>
                                        <td><code>tags</code></td>
                                        <td>array</td>
                                        <td>No</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td><code>links</code></td>
                                        <td>object</td>
                                        <td>No</td>
                                        <td>name to URL</td>
                                    </tr>
                                    <tr>
                                        <td><code>duration</code></td>
                                        <td>number</td>
                                        <td>No</td>
                                        <td>Runtime in minutes (for critical path)</td>
                                    </tr>
                                    <tr>
                                        <td><code>cost</code></td>
                                        <td>number</td>
                                        <td>No</td>
                                        <td>Cost per run (for spend analysis)</td>
                                    </tr>
                                </table>
                                <pre class="spec-pre">
{
  "name": "user-enrichment",
  "description": "Enriches user data with events",
  "input_sources": ["raw_users", "events"],
  "output_sources": ["enriched_users"],
  "upstream_pipelines": ["data-ingestion"],
  "cluster": "user-processing",
  "group": "etl-jobs",
  "schedule": "Every 2 hours",
  "duration": 45,
  "cost": 12.50,
  "tags": ["user-data", "ml"],
  "links": {
    "airflow": "https://...",
    "docs": "https://..."
  }
}</pre
                                >
                            </div>

                            <div class="spec-section">
                                <h6>Datasource</h6>
                                <p style="color: var(--text-secondary); font-size: 12px; margin-bottom: 0.5rem">
                                    Auto-created when referenced. Define explicitly to add metadata.
                                </p>
                                <table class="spec-table">
                                    <tr>
                                        <th>Field</th>
                                        <th>Type</th>
                                        <th>Required</th>
                                        <th>Description</th>
                                    </tr>
                                    <tr>
                                        <td><code>name</code></td>
                                        <td>string</td>
                                        <td>Yes</td>
                                        <td>Unique identifier</td>
                                    </tr>
                                    <tr>
                                        <td><code>description</code></td>
                                        <td>string</td>
                                        <td>No</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td><code>type</code></td>
                                        <td>string</td>
                                        <td>No</td>
                                        <td>snowflake, postgres, kafka, s3...</td>
                                    </tr>
                                    <tr>
                                        <td><code>owner</code></td>
                                        <td>string</td>
                                        <td>No</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td><code>cluster</code></td>
                                        <td>string</td>
                                        <td>No</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td><code>tags</code></td>
                                        <td>array</td>
                                        <td>No</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td><code>metadata</code></td>
                                        <td>object</td>
                                        <td>No</td>
                                        <td>Arbitrary key-value</td>
                                    </tr>
                                    <tr>
                                        <td><code>links</code></td>
                                        <td>object</td>
                                        <td>No</td>
                                        <td>name to URL</td>
                                    </tr>
                                    <tr>
                                        <td><code>attributes</code></td>
                                        <td>array</td>
                                        <td>No</td>
                                        <td>Column-level lineage</td>
                                    </tr>
                                </table>
                                <pre class="spec-pre">
{
  "name": "raw_users",
  "description": "Raw user data from prod",
  "type": "snowflake",
  "owner": "data-team@company.com",
  "cluster": "user-processing",
  "tags": ["pii", "users"],
  "metadata": {
    "size": "2.1TB",
    "record_count": "45M"
  },
  "links": {
    "snowflake": "https://...",
    "docs": "https://..."
  }
}</pre
                                >
                            </div>

                            <div class="spec-section">
                                <h6>Cluster</h6>
                                <p style="color: var(--text-secondary); font-size: 12px; margin-bottom: 0.5rem">
                                    Auto-created when referenced. Define explicitly for nesting.
                                </p>
                                <table class="spec-table">
                                    <tr>
                                        <th>Field</th>
                                        <th>Type</th>
                                        <th>Required</th>
                                        <th>Description</th>
                                    </tr>
                                    <tr>
                                        <td><code>name</code></td>
                                        <td>string</td>
                                        <td>Yes</td>
                                        <td>Unique identifier</td>
                                    </tr>
                                    <tr>
                                        <td><code>description</code></td>
                                        <td>string</td>
                                        <td>No</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td><code>parent</code></td>
                                        <td>string</td>
                                        <td>No</td>
                                        <td>Parent cluster for nesting</td>
                                    </tr>
                                </table>
                                <pre class="spec-pre">
{
  "name": "realtime",
  "description": "Real-time processing cluster",
  "parent": "order-processing"
}</pre
                                >
                            </div>

                            <div class="spec-section">
                                <h6>Attribute Lineage</h6>
                                <p style="color: var(--text-secondary); font-size: 12px; margin-bottom: 0.5rem">
                                    Add <code>attributes</code> to a datasource. Supports nesting for structs/objects.
                                    Reference upstream with <code>source::attr</code> or
                                    <code>source::parent::child</code>.
                                </p>
                                <table class="spec-table">
                                    <tr>
                                        <th>Field</th>
                                        <th>Type</th>
                                        <th>Required</th>
                                        <th>Description</th>
                                    </tr>
                                    <tr>
                                        <td><code>name</code></td>
                                        <td>string</td>
                                        <td>Yes</td>
                                        <td>Column/field name</td>
                                    </tr>
                                    <tr>
                                        <td><code>from</code></td>
                                        <td>string or array</td>
                                        <td>No</td>
                                        <td>Upstream refs</td>
                                    </tr>
                                    <tr>
                                        <td><code>attributes</code></td>
                                        <td>array</td>
                                        <td>No</td>
                                        <td>Nested child attributes</td>
                                    </tr>
                                </table>
                                <pre class="spec-pre">
{
  "name": "enriched_users",
  "attributes": [
    { "name": "user_id", "from": "raw_users::id" },
    {
      "name": "location",
      "from": "raw_users::address",
      "attributes": [
        { "name": "city", "from": "raw_users::address::city" },
        { "name": "zip", "from": "raw_users::address::zip" }
      ]
    }
  ]
}</pre
                                >
                            </div>

                            <div class="spec-section">
                                <h6>Full Example</h6>
                                <pre class="spec-pre">
{
  "clusters": [
    { "name": "etl", "description": "ETL pipelines" }
  ],
  "pipelines": [
    {
      "name": "user-enrichment",
      "description": "Enriches user data with events",
      "input_sources": ["raw_users", "events"],
      "output_sources": ["enriched_users"],
      "cluster": "etl",
      "schedule": "Every 2 hours",
      "tags": ["user-data"],
      "links": { "airflow": "https://..." }
    }
  ],
  "datasources": [
    {
      "name": "raw_users",
      "type": "snowflake",
      "owner": "data-team@company.com",
      "attributes": [
        { "name": "id" },
        { "name": "first" },
        { "name": "last" }
      ]
    },
    {
      "name": "enriched_users",
      "type": "snowflake",
      "attributes": [
        { "name": "user_id", "from": "raw_users::id" },
        { "name": "full_name", "from": ["raw_users::first", "raw_users::last"] }
      ]
    }
  ]
}</pre
                                >
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Spec Modal -->
        <div class="modal fade" id="specModal" tabindex="-1" aria-labelledby="specModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="specModalLabel">json spec</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-4">
                            <h6>Overview</h6>
                            <p class="text-muted">
                                Pipeviz uses a simple JSON configuration to define your data lineage. Only pipelines are
                                required. Clusters and datasources are auto-created when referenced, but you can add
                                rich descriptors for better documentation.
                            </p>
                        </div>

                        <div class="mb-4">
                            <h6>Root Structure</h6>
                            <pre class="bg-light p-3 rounded"><code>{
  "clusters": [ ... ],     // Optional: cluster definitions
  "pipelines": [ ... ],    // Required: pipeline definitions
  "datasources": [ ... ]   // Optional: rich data source definitions
}</code></pre>
                        </div>

                        <div class="mb-4">
                            <h6>Clusters (Optional)</h6>
                            <p class="text-muted small">
                                Clusters can be optionally declared upfront or referenced on-the-fly. Support nested
                                hierarchies with parent relationships.
                            </p>
                            <pre class="bg-light p-3 rounded"><code>{
  "name": "real-time",
  "description": "Real-time processing cluster",  // Optional
  "parent": "order-management"                    // Optional: creates nested cluster
}</code></pre>
                        </div>

                        <div class="mb-4">
                            <h6>Pipelines</h6>
                            <pre class="bg-light p-3 rounded"><code>{
  "name": "user-enrichment",
  "description": "Enriches user data...",       // Optional
  "input_sources": ["raw_users", "events"],     // Optional
  "output_sources": ["enriched_users"],         // Optional
  "schedule": "Every 2 hours",                  // Optional
  "tags": ["user-data", "ml"],                  // Optional
  "cluster": "user-processing",                 // Optional: single cluster
  "upstream_pipelines": ["data-ingestion"],     // Optional
  "links": {                                    // Optional
    "airflow": "https://...",
    "monitoring": "https://..."
  }
}</code></pre>
                        </div>

                        <div class="mb-4">
                            <h6>Data Sources (Optional)</h6>
                            <p class="text-muted small">
                                Data sources are auto-created when referenced in pipelines. Define them explicitly to
                                add rich metadata, ownership, and documentation.
                            </p>
                            <pre class="bg-light p-3 rounded"><code>{
  "name": "raw_users",
  "description": "Raw user data...",            // Optional
  "type": "snowflake",                          // Optional
  "owner": "data-team@company.com",             // Optional
  "tags": ["pii", "users"],                     // Optional
  "cluster": "user-processing",                 // Optional: single cluster
  "metadata": {                                 // Optional
    "size": "2.1TB",
    "record_count": "45M"
  },
  "links": {                                    // Optional
    "snowflake": "https://...",
    "docs": "https://..."
  }
}</code></pre>
                        </div>

                        <div class="alert alert-info">
                            <strong>Tips:</strong>
                            <ul class="mb-0 mt-2">
                                <li>
                                    Only <code>pipelines</code> array with pipeline <code>name</code> fields is required
                                </li>
                                <li>Clusters and datasources are auto-created when referenced in pipelines</li>
                                <li>Define datasources explicitly to add rich metadata, ownership, and links</li>
                                <li>Use <code>cluster</code> (singular) to assign nodes to one cluster each</li>
                                <li>
                                    Create nested clusters using the <code>parent</code> field in cluster definitions
                                </li>
                                <li>Use <code>upstream_pipelines</code> to show pipeline dependencies</li>
                                <li>Links can point to any external tools (Airflow, monitoring, docs, etc.)</li>
                            </ul>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Blast Radius Modal -->
        <div
            class="modal fade"
            id="blastRadiusModal"
            tabindex="-1"
            aria-labelledby="blastRadiusModalLabel"
            aria-hidden="true"
        >
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="blastRadiusModalLabel">
                            <span style="color: #c98b8b"></span> Blast Radius:
                            <span id="blast-radius-node-name"></span>
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" style="padding: 0">
                        <div class="row g-0">
                            <div class="col-md-8">
                                <div
                                    id="blast-radius-graph"
                                    style="
                                        height: 500px;
                                        background: var(--bg-primary);
                                        overflow: hidden;
                                        touch-action: none;
                                    "
                                ></div>
                            </div>
                            <div
                                class="col-md-4"
                                style="border-left: 1px solid var(--border-color); height: 500px; overflow-y: auto"
                            >
                                <div id="blast-radius-summary" style="padding: 1rem"></div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script type="module" src="/src/main.js"></script>
    </body>
</html>
